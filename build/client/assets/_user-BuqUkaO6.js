import{R as r,r as h,u as Ce,a as $e,j as t,f as Te,L as Z,O as _e}from"./components-Cj7Yk1Hh.js";import{p as je}from"./package-4EXXHvaL.js";import{a as ge,u as W,c as k,_ as U,P as e,d as Ie,f as Le}from"./index-_rCr0AGk.js";import{G as we,C as ce}from"./Column-BatEsPZP.js";import{u as ae,a as De}from"./useMatchMedia-DCVgUbq7.js";import{a as X,m as K,A as de,h as ue,f as fe,S as Ae,i as me,j as pe,H as ee,k as ne,l as be,b as Fe,E as Re,T as ke}from"./Button-Bl4KegFP.js";import{h as Pe,i as He}from"./TextInput-CKh2Yhf_.js";import{L as Me,d as Oe,A as Ee,H as Ke,S as Ve,a as Be,b as We,c as Ne,F as Ge}from"./footer-CNEF_Boy.js";import{H as qe}from"./HeaderMenuButton-DkuNHRv5.js";import{S as he}from"./connection-DdvKsJfI.js";import{a as ze}from"./database-Dl88dlG2.js";import{a as Ue}from"./github_widget-X-pkoqDF.js";import{L as Je}from"./logo-BYODAW8L.js";import{D as Qe,a as Xe}from"./bucket-4-DNu0uQyD.js";import{U as Ye}from"./bucket-17-BFRBnihc.js";import{L as Ze}from"./bucket-10-BakHwRxf.js";import"./wrapComponent-DVKhoVmh.js";import"./bucket-3-B5cXRAyd.js";import"./index-DCm1eCXF.js";import"./Modal-K69mcxHf.js";import"./index-BgfNTfNX.js";import"./index-B37bIhWk.js";let xe=0;function ye(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";return xe++,`${o}${xe}`}const Y=r.forwardRef((o,p)=>{let{active:x,children:u,className:E,depth:y,disabled:f,id:j,isExpanded:b,defaultIsExpanded:I,label:N,onNodeFocusEvent:T,onSelect:v,onToggle:R,onTreeSelect:C,renderIcon:S,selected:d,value:l,...w}=o;const g=y,m=d,_=ge("enable-treeview-controllable"),{current:D}=h.useRef(j||ye()),V=ae({value:b,onChange:R,defaultValue:I}),B=h.useState(b),[L,$]=_?V:B,P=h.useRef(null),H=h.useRef(null),c=W(),G=s=>{P.current=s,typeof p=="function"?p(s):p&&(p.current=s)},J=r.Children.map(u,s=>{if(r.isValidElement(s))return r.cloneElement(s,{active:x,depth:g+1,disabled:f||s.props.disabled,onTreeSelect:C,selected:m,tabIndex:!s.props.disabled&&-1||null})}),Q=x===D,M=m.includes(D),F=k(E,`${c}--tree-node`,{[`${c}--tree-node--active`]:Q,[`${c}--tree-node--disabled`]:f,[`${c}--tree-node--selected`]:M,[`${c}--tree-node--with-icon`]:S,[`${c}--tree-leaf-node`]:!u,[`${c}--tree-parent-node`]:u}),a=k(`${c}--tree-parent-node__toggle-icon`,{[`${c}--tree-parent-node__toggle-icon--expanded`]:L});function i(s){f||(s.stopPropagation(),_||R?.(s,{id:D,isExpanded:!L,label:N,value:l}),$(!L))}function n(s){s.stopPropagation(),f||(C?.(s,{id:D,label:N,value:l}),v?.(s,{id:D,label:N,value:l}),w?.onClick?.(s))}function A(s){if(!f){if(X(s,[de,ue,fe])&&s.stopPropagation(),K(s,de)){const ie=O=>O?O.classList.contains(`${c}--tree-parent-node`)?O:O.classList.contains(`${c}--tree`)?null:ie(O.parentElement):null;if(u&&L)_||R?.(s,{id:D,isExpanded:!1,label:N,value:l}),$(!1);else{const O=ie(P.current?.parentElement||null);O instanceof HTMLElement&&O.focus()}}u&&K(s,ue)&&(L?(P.current?.lastChild?.firstChild).focus():(_||R?.(s,{id:D,isExpanded:!0,label:N,value:l}),$(!0))),X(s,[fe,Ae])&&(s.preventDefault(),n(s)),w?.onKeyDown?.(s)}}function q(s){s.type==="blur"&&w?.onBlur?.(s),s.type==="focus"&&w?.onFocus?.(s),T?.(s)}h.useEffect(()=>{const s=()=>u&&S?g+1+g*.5:u?g+1:S?g+2+g*.5:g+2.5;H.current&&(H.current.style.marginInlineStart=`-${s()}rem`,H.current.style.paddingInlineStart=`${s()}rem`),_||$(b)},[u,g,S,b,_,$]);const oe={...w,"aria-current":Q||void 0,"aria-selected":f?void 0:M,"aria-disabled":f,className:F,id:D,onBlur:q,onClick:n,onFocus:q,onKeyDown:A,role:"treeitem"};return u?r.createElement("li",U({},oe,{"aria-expanded":!!L,ref:G}),r.createElement("div",{className:`${c}--tree-node__label`,ref:H},r.createElement("span",{className:`${c}--tree-parent-node__toggle`,disabled:f,onClick:i},r.createElement(Pe,{className:a})),r.createElement("span",{className:`${c}--tree-node__label__details`},S&&r.createElement(S,{className:`${c}--tree-node__icon`}),N)),r.createElement("ul",{role:"group",className:k(`${c}--tree-node__children`,{[`${c}--tree-node--hidden`]:!L})},J)):r.createElement("li",U({},oe,{ref:G}),r.createElement("div",{className:`${c}--tree-node__label`,ref:H},S&&r.createElement(S,{className:`${c}--tree-node__icon`}),N))});Y.propTypes={active:e.oneOfType([e.string,e.number]),children:e.node,className:e.string,defaultIsExpanded:e.bool,depth:e.number,disabled:e.bool,id:e.string,isExpanded:e.bool,label:e.node,onNodeFocusEvent:e.func,onSelect:e.func,onToggle:e.func,onTreeSelect:e.func,renderIcon:e.oneOfType([e.func,e.object]),selected:e.arrayOf(e.oneOfType([e.string,e.number])),value:e.string};Y.displayName="TreeNode";const re=o=>{let{active:p,children:x,className:u,hideLabel:E=!1,label:y,multiselect:f=!1,onActivate:j,onSelect:b,selected:I,size:N="sm",...T}=o;const v=ge("enable-treeview-controllable"),{current:R}=h.useRef(T.id||ye()),C=W(),S=k(u,`${C}--tree`,{[`${C}--tree--${N}`]:N!=="default"}),d=h.useRef(null),l=h.useRef(d?.current),w=ae({value:I,onChange:b,defaultValue:[]}),g=h.useState(I??[]),[m,_]=v?w:g,D=ae({value:p,onChange:j,defaultValue:void 0}),V=h.useState(p),[B,L]=v?D:V;function $(){Array.prototype.forEach.call(d?.current?.querySelectorAll('[tabIndex="0"]')??[],a=>{a.tabIndex=-1})}function P(a){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=i.id;f&&(a.metaKey||a.ctrlKey)?(m.includes(n)?_(m.filter(A=>A!==n)):_(m.concat(n)),v||b?.(a,i)):(_([n]),L(n),v||b?.(a,{activeNodeId:n,...i}))}function H(a){if(a.type==="blur"){const{relatedTarget:i,target:n}=a;d?.current?.contains(i)&&(n.tabIndex=-1)}if(a.type==="focus"){$();const{relatedTarget:i,target:n}=a;d?.current?.contains(i)&&(i.tabIndex=-1),n.tabIndex=0}}let c=!1;const G=r.Children.map(x,a=>{const i=a,n={active:B,depth:0,onNodeFocusEvent:H,onTreeSelect:P,selected:m,tabIndex:!i.props.disabled&&-1||void 0};if(!c&&!i.props.disabled&&(n.tabIndex=0,c=!0),r.isValidElement(i))return r.cloneElement(i,n)});function J(a){if(a.stopPropagation(),X(a,[me,pe,ee,ne,{code:"KeyA"}])&&a.preventDefault(),!l.current)return;l.current.currentNode=a.target;let i=null;if(K(a,me)&&(i=l.current.previousNode()),K(a,pe)&&(i=l.current.nextNode()),X(a,[ee,ne,{code:"KeyA"}])){const n=[];if(X(a,[ee,ne]))for(f&&a.shiftKey&&a.ctrlKey&&l.current.currentNode instanceof Element&&!l.current.currentNode.getAttribute("aria-disabled")&&!l.current.currentNode.classList.contains(`${C}--tree-node--hidden`)&&n.push(l.current.currentNode?.id);K(a,ee)?l.current.previousNode():l.current.nextNode();)i=l.current.currentNode,f&&a.shiftKey&&a.ctrlKey&&i instanceof Element&&!i.getAttribute("aria-disabled")&&!i.classList.contains(`${C}--tree-node--hidden`)&&n.push(i?.id);if(K(a,{code:"KeyA"})&&a.ctrlKey)for(l.current.currentNode=l.current.root;l.current.nextNode();)l.current.currentNode instanceof Element&&!l.current.currentNode.getAttribute("aria-disabled")&&!l.current.currentNode.classList.contains(`${C}--tree-node--hidden`)&&n.push(l.current.currentNode?.id);_(m.concat(n))}i&&i!==a.target&&($(),i instanceof HTMLElement&&(i.tabIndex=0,i.focus())),T?.onKeyDown?.(a)}h.useEffect(()=>{l.current=l.current??document.createTreeWalker(d?.current,NodeFilter.SHOW_ELEMENT,{acceptNode:function(a){return a instanceof Element?a.classList.contains(`${C}--tree-node--disabled`)||a.classList.contains(`${C}--tree-node--hidden`)?NodeFilter.FILTER_REJECT:a.matches(`li.${C}--tree-node`)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_SKIP}})},[C]),h.useEffect(()=>{v||(I?.length&&_(I),p&&L(p))},[]);const M=`${R}__label`,F=()=>E?null:r.createElement("label",{id:M,className:`${C}--label`},y);return r.createElement(r.Fragment,null,r.createElement(F,null),r.createElement("ul",U({},T,{"aria-label":E?y:void 0,"aria-labelledby":E?void 0:M,"aria-multiselectable":f||void 0,className:S,onKeyDown:J,ref:d,role:"tree"}),G))};re.propTypes={active:e.oneOfType([e.string,e.number]),children:e.node,className:e.string,hideLabel:e.bool,label:e.string.isRequired,multiselect:e.bool,onActivate:e.func,onSelect:e.func,selected:e.arrayOf(e.oneOfType([e.string,e.number])),size:e.oneOf(["xs","sm"])};re.TreeNode=Y;const z=h.forwardRef(function(p,x){let{className:u,isActive:E,isCurrentPage:y,"aria-current":f,children:j,role:b,tabIndex:I=0,...N}=p;const T=W();y&&(E=y);const v=k({[`${T}--header__menu-item`]:!0,[`${T}--header__menu-item--current`]:E&&f!=="page"});return r.createElement("li",{className:u,role:b},r.createElement(Me,U({},N,{"aria-current":f,className:v,ref:x,tabIndex:I}),r.createElement("span",{className:`${T}--text-truncate--end`},j)))});z.displayName="HeaderMenuItem";z.propTypes={...Oe,children:e.node.isRequired,className:e.string,isActive:e.bool,isCurrentPage:Ie(e.bool),role:e.string,tabIndex:e.number};function te(o){let{"aria-label":p,"aria-labelledby":x,children:u,className:E,...y}=o;const f=W(),j=k(`${f}--header__nav`,E);return r.createElement("nav",U({},y,{"aria-label":p,"aria-labelledby":x,className:j}),r.createElement("ul",{className:`${f}--header__menu-bar`},u))}te.propTypes={...Ee,children:e.node,className:e.string};function ve(o){let{className:p,children:x,hasDivider:u=!1}=o;const E=W(),y=k({[`${E}--side-nav__header-navigation`]:!0,[`${E}--side-nav__header-divider`]:u},p);return r.createElement("ul",{className:y},x)}ve.propTypes={children:e.node,className:e.string,hasDivider:e.bool};const Se=["SideNavFooter","SideNavHeader","SideNavItems","SideNavMenu","SideNavLink"],et=h.createContext({});function tt(o,p){let{expanded:x,defaultExpanded:u=!1,isChildOfHeader:E=!0,"aria-label":y,"aria-labelledby":f,children:j,onToggle:b,className:I,href:N,isFixedNav:T=!1,isRail:v,isPersistent:R=!0,addFocusListeners:C=!0,addMouseListeners:S=!0,onOverlayClick:d,onSideNavBlur:l,enterDelayMs:w=100,...g}=o;const m=W(),{current:_}=h.useRef(x!==void 0),[D,V]=be(u),[B,L]=be(u),$=_?x:D,P=h.useRef(null),H=Fe([P,p]),c=function(n){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!$;_||V(A,w),b&&b(n,A),(_||v)&&L(A,w)},G={"aria-label":y,"aria-labelledby":f},J=k(I,{[`${m}--side-nav`]:!0,[`${m}--side-nav--expanded`]:$||B,[`${m}--side-nav--collapsed`]:!$&&T,[`${m}--side-nav--rail`]:v,[`${m}--side-nav--ux`]:E,[`${m}--side-nav--hidden`]:!R}),Q=k({[`${m}--side-nav__overlay`]:!0,[`${m}--side-nav__overlay-active`]:$||B});let M=j;M=r.Children.map(j,n=>{const A=_&&B||$;if(h.isValidElement(n)){const q=n;return r.cloneElement(q,{...Se.includes(q.type?.displayName??q.type?.name)?{isSideNavExpanded:A}:{}})}return n});const F={};C&&(F.onFocus=n=>{!n.currentTarget.contains(n.relatedTarget)&&v&&c(n,!0)},F.onBlur=n=>{n.currentTarget.contains(n.relatedTarget)||c(n,!1),!n.currentTarget.contains(n.relatedTarget)&&$&&!T&&l&&l()},F.onKeyDown=n=>{K(n,Re)&&(c(n,!1),N&&(window.location.href=N))}),S&&v&&(F.onMouseEnter=()=>{c(!0,!0)},F.onMouseLeave=()=>{V(!1),L(!1),c(!1,!1)},F.onClick=()=>{V(!0),L(!0),c(!0,!0)}),Le("keydown",n=>{const A=document.activeElement;K(n,ke)&&$&&!T&&P.current&&A?.classList.contains(`${m}--header__menu-toggle`)&&!A.closest("nav")&&P.current.focus()});const a=`(min-width: ${He.lg.width})`,i=De(a);return r.createElement(et.Provider,{value:{isRail:v}},T?null:r.createElement("div",{className:Q,onClick:d}),r.createElement("nav",U({tabIndex:-1,ref:H,className:`${m}--side-nav__navigation ${J}`,inert:v||$||i?void 0:-1},G,F,g),M))}const se=r.forwardRef(tt);se.displayName="SideNav";se.propTypes={...Ee,addFocusListeners:e.bool,addMouseListeners:e.bool,className:e.string,defaultExpanded:e.bool,enterDelayMs:e.number,expanded:e.bool,href:e.string,isChildOfHeader:e.bool,isFixedNav:e.bool,isPersistent:e.bool,isRail:e.bool,onOverlayClick:e.func,onSideNavBlur:e.func,onToggle:e.func};const le=o=>{let{className:p,children:x,isSideNavExpanded:u}=o;const E=W(),y=k([`${E}--side-nav__items`],p),f=r.Children.map(x,j=>{if(r.isValidElement(j)){const b=j.type?.displayName;return r.cloneElement(j,{...Se.includes(b)?{isSideNavExpanded:u}:{}})}});return r.createElement("ul",{className:y},f)};le.displayName="SideNavItems";le.propTypes={children:e.node.isRequired,className:e.string,isSideNavExpanded:e.bool};function Ct(){const o=Ce(),p=$e(),[x,u]=h.useState(!1),[E,y]=h.useState(!1);let f=o.selectedDb?o.selectedDb:"",j=o.selectedCollection?o.selectedCollection:"";const[b,I]=h.useState({db:f,collection:j});h.useEffect(()=>{if(o.selectedDb!=b.db||o.selectedCollection!=b.collection){let S=o.selectedDb?o.selectedDb:"",d=o.selectedCollection?o.selectedCollection:"";I({db:S,collection:d})}},[o.selectedDb]);let N=[],T=[];if(o){const S=Object.keys(o.collections);S.sort((d,l)=>d>l?1:-1),T=S.map((d,l)=>{d==b.db&&(N=[l.toString()]);const w=o.collections[d].sort((g,m)=>g.name>m.name?1:-1);return t.jsx(Y,{isExpanded:d==b.db,onSelect:()=>{I({db:d,collection:""}),p(`/database/${d}`)},id:l.toString(),label:d,tabIndex:0,children:w.map((g,m)=>(d==b.db&&g.name==b.collection&&N.push(m.toString()),t.jsx(Y,{id:`${l}-${m}`,onSelect:()=>{I({db:d,collection:g.name}),p(`/database/${d}/${g.name}`)},renderIcon:Qe,label:g.name},g.name)))},d)})}const v=()=>{y(!0)},{pathname:R}=Te(),C=t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between px-4 py-2",children:[t.jsx("span",{className:"block text-xs uppercase opacity-50",children:"Databases"}),t.jsx(Z,{className:"text-xs uppercase opacity-50 hover:underline hover:opacity-100",to:"/database",children:t.jsx(Xe,{})})]}),t.jsx(re,{size:"sm",multiselect:!1,selected:[N[0],N.join("-")],active:N[0],hideLabel:!0,label:"Databases","aria-expanded":!0,children:T})]});return t.jsxs(t.Fragment,{children:[t.jsxs(Ke,{"aria-label":"",children:[t.jsx(Ve,{}),t.jsx(qe,{"aria-label":"Open menu",onClick:()=>{u(!x)},isActive:x}),t.jsx(Be,{as:Z,to:"/",prefix:"",children:t.jsx(Je,{className:"h-5"})}),t.jsx(te,{"aria-label":"Connections",children:t.jsx(z,{as:"div",className:"flex items-center mr-4",children:t.jsx(he,{current:o.connection,connections:o.connections})})}),t.jsx(te,{"aria-label":"New Database",children:t.jsx(z,{onClick:v,children:"New Database"})}),t.jsxs(We,{children:[t.jsx(Ue,{repo:"n-for-all/mongocarbon",version:je.version,title:"MongoCarbon"}),t.jsx(Z,{to:"/profile",children:t.jsx(Ne,{"aria-label":"User Profile",children:t.jsx(Ye,{size:20})})}),t.jsx(Ne,{"aria-label":"Logout",children:t.jsx(Z,{to:"/logout",children:t.jsx(Ze,{size:20})})})]}),t.jsx(se,{"aria-label":"Side navigation",expanded:x,isPersistent:!1,onSideNavBlur:()=>{u(!1)},children:t.jsx(le,{children:t.jsxs(ve,{children:[t.jsx(z,{as:"div",className:"flex items-center mr-4",children:t.jsx(he,{current:o.connection,connections:o.connections})}),t.jsx(te,{"aria-label":"New Database",children:t.jsx(z,{onClick:v,children:"New Database"})}),t.jsx("div",{className:"relative top-0 left-0 w-full h-full overflow-auto",children:C})]})})})]}),t.jsx("div",{className:"h-screen pt-12",children:t.jsxs(we,{className:"h-full pl-0 pr-0",fullWidth:!0,children:[!x&&t.jsx(ce,{lg:3,md:8,sm:4,className:"relative h-full ml-0 border-r border-solid border-neutral-100",children:t.jsx("div",{className:"absolute top-0 left-0 w-full h-full overflow-auto",children:C})}),t.jsx(ce,{lg:13,md:8,sm:4,className:"h-full pt-5 mr-0 overflow-auto",children:t.jsx("div",{className:"pr-4 lg:pr-8",children:t.jsx(_e,{},R+"-content")})})]})}),t.jsx(Ge,{}),t.jsx(ze,{open:E,onClose:()=>{y(!1)},onSuccess:(S,d)=>{y(!1),p(`/database/${S}/${d}`,{replace:!0})}})]})}export{Ct as default};
