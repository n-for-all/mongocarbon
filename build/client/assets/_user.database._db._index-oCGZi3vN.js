import{u as B,r as o,a as A,j as e}from"./components-Cj7Yk1Hh.js";import"./index-_rCr0AGk.js";import{A as E,a as F}from"./AccordionItem-DNYUtNot.js";import{B as m}from"./Button-Bl4KegFP.js";import{G as O,C as v}from"./Column-BatEsPZP.js";import{I as M}from"./Notification-t-CAZq57.js";import{S as R,a as V,b as $}from"./Search-BNe1a6wo.js";import{T as G,S as W,a as c,c as h,n as r}from"./functions-B7s41jYM.js";import{T as S,a as p,b as l,c as t}from"./TableRow-Zi2gF0TG.js";import{C as q,a as U}from"./collection-D6bPwBCG.js";import{D as H}from"./database-Dl88dlG2.js";import{A as P,a as Z}from"./bucket-3-B5cXRAyd.js";import{T as D}from"./bucket-17-BFRBnihc.js";import{D as J}from"./bucket-4-DNu0uQyD.js";import"./TextInput-CKh2Yhf_.js";import"./index-B37bIhWk.js";import"./Modal-K69mcxHf.js";import"./index-BgfNTfNX.js";function he(){const j=B(),[y,C]=o.useState(""),[i,T]=o.useState("asc"),[L,g]=o.useState(!1),b=A(),[u,I]=o.useState(""),[w,N]=o.useState(!1),[z,f]=o.useState(null),a=j?.stats;if(j?.error)return e.jsx(M,{title:"Error",subtitle:j.error,hideCloseButton:!0});if(!a)return e.jsx("div",{children:"Loading..."});let k=0;switch(y){case"name":i=="desc"?a.collectionList.sort((s,n)=>n.name.localeCompare(s.name)):a.collectionList.sort((s,n)=>s.name.localeCompare(n.name));break;case"documents":i=="desc"?a.collectionList.sort((s,n)=>n.count-s.count):a.collectionList.sort((s,n)=>s.count-n.count);break;case"document-size":i=="desc"?a.collectionList.sort((s,n)=>{const d=n.stats.storageStats?.storageSize/n.count,x=s.stats.storageStats?.storageSize/s.count;return d-x}):a.collectionList.sort((s,n)=>{const d=s.stats.storageStats?.storageSize/s.count,x=n.stats.storageStats?.storageSize/n.count;return d-x});break;case"storage-size":i=="desc"?a.collectionList.sort((s,n)=>n.stats.storageStats?.storageSize-s.stats.storageStats?.storageSize):a.collectionList.sort((s,n)=>s.stats.storageStats?.storageSize-n.stats.storageStats?.storageSize);break;case"indexes":i=="desc"?a.collectionList.sort((s,n)=>n.indexes.length-s.indexes.length):a.collectionList.sort((s,n)=>n.indexes.length-s.indexes.length);break;case"index-size":i=="desc"?a.collectionList.sort((s,n)=>n.stats.storageStats?.totalIndexSize-s.stats.storageStats?.totalIndexSize):a.collectionList.sort((s,n)=>s.stats.storageStats?.totalIndexSize-n.stats.storageStats?.totalIndexSize);break}return e.jsxs(e.Fragment,{children:[e.jsxs(O,{className:"database-page",fullWidth:!0,children:[e.jsxs(v,{lg:16,md:8,sm:4,children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 pb-4 lg:flex-nowrap",children:[e.jsxs("div",{children:[e.jsxs(G,{title:a.name,children:[e.jsx("span",{className:"font-normal opacity-50",children:"Database:"})," ",a.name]}),e.jsxs("p",{className:"mb-4 text-sm",children:["Collections: ",a.collections,", Documents: ",k]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(m,{size:"sm",kind:"tertiary",renderIcon:P,iconDescription:"Create Collection",onClick:s=>{s.preventDefault(),N(!0)},children:"Create Collection"}),e.jsx(m,{size:"sm",kind:"danger--tertiary",renderIcon:D,iconDescription:"Delete Database",onClick:s=>{s.preventDefault(),g(!0)},children:"Drop Database"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(R,{placeholder:"Find a collection",labelText:"Search",closeButtonLabelText:"Clear search input",id:"search-collection",onChange:s=>{I(s.target.value)}}),e.jsx("span",{className:"text-sm",children:"Sort:"}),e.jsxs(W,{hideLabel:!0,id:"sort",onChange:s=>{C(s.target.value)},children:[e.jsx(c,{value:"",text:"---"}),e.jsx(c,{value:"name",text:"By Name"}),e.jsx(c,{value:"documents",text:"By Documents"}),e.jsx(c,{value:"document-size",text:"By Avg. Document Size"}),e.jsx(c,{value:"storage-size",text:"By Storage Size"}),e.jsx(c,{value:"indexes",text:"By Indexes"}),e.jsx(c,{value:"index-size",text:"By Total Index Size"})]}),e.jsx(m,{hasIconOnly:!0,size:"md",kind:"ghost",renderIcon:i=="asc"?V:$,iconDescription:"Sort Direction",onClick:s=>{s.preventDefault(),T(i=="asc"?"desc":"asc")}})]})]}),a.collectionList.map((s,n)=>{if(u&&u.trim()!=""&&s.name.toLowerCase().indexOf(u.toLowerCase())!=0)return null;const d=s.stats.storageStats?.storageSize/s.count;return e.jsxs("div",{className:"mb-3 bg-neutral-100",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 px-4 py-2 text-base border-b border-solid border-neutral-200",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(J,{})," ",e.jsx("strong",{children:s.name})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(m,{kind:"danger--tertiary",renderIcon:D,size:"sm",onClick:x=>{x.preventDefault(),f(s.name)},children:"Delete"}),e.jsx(m,{kind:"tertiary",renderIcon:Z,size:"sm",href:`/database/${a.name}/${s.name}`,children:"View"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 px-4 py-2 lg:grid-cols-5",children:[e.jsxs("div",{className:"flex flex-col text-sm",children:[e.jsx("span",{className:"block mb-1 font-bold",children:"Storage size:"}),e.jsx("span",{className:"font-normal",children:h(s.stats.storageStats?.storageSize)})]}),e.jsxs("div",{className:"flex flex-col text-sm",children:[e.jsx("span",{className:"block mb-1 font-bold",children:"Documents:"}),e.jsx("span",{className:"font-normal",children:s.count})]}),e.jsxs("div",{className:"flex flex-col text-sm",children:[e.jsx("span",{className:"block mb-1 font-bold",children:"Avg. document size:"}),e.jsx("span",{className:"font-normal",children:h(d)})]}),e.jsxs("div",{className:"flex flex-col text-sm",children:[e.jsx("span",{className:"block mb-1 font-bold",children:"Indexes:"}),e.jsx("span",{className:"font-normal",children:s.indexes.length})]}),e.jsxs("div",{className:"flex flex-col text-sm",children:[e.jsx("span",{className:"block mb-1 font-bold",children:"Total index size:"}),e.jsx("span",{className:"font-normal",children:h(s.stats.storageStats?.totalIndexSize)})]})]}),e.jsx(E,{children:e.jsx(F,{title:"More Details",className:"pr-0 ",children:e.jsxs("div",{className:"flex flex-col items-start w-full pb-4 lg:flex-row",children:[e.jsx("div",{className:"flex-1 w-full",children:e.jsx(S,{children:e.jsxs(p,{children:[e.jsxs(l,{children:[e.jsx(t,{className:"font-bold",children:"Namespace"}),e.jsx(t,{children:s.stats.ns})]}),e.jsxs(l,{children:[e.jsx(t,{className:"font-bold",children:"Host"}),e.jsx(t,{children:s.stats.host})]}),e.jsxs(l,{children:[e.jsx(t,{className:"font-bold",children:"Local Time"}),e.jsx(t,{children:s.stats.localTime})]}),e.jsxs(l,{children:[e.jsx(t,{className:"font-bold",children:"Reads Latency"}),e.jsxs(t,{children:[r(s.stats.latencyStats?.reads.latency)," ms"]})]}),e.jsxs(l,{children:[e.jsx(t,{className:"font-bold",children:"Writes Latency"}),e.jsxs(t,{children:[r(s.stats.latencyStats?.writes.latency)," ms"]})]}),e.jsxs(l,{children:[e.jsx(t,{className:"font-bold",children:"Commands Latency"}),e.jsxs(t,{children:[r(s.stats.latencyStats?.commands.latency)," ms"]})]}),e.jsxs(l,{children:[e.jsx(t,{className:"font-bold",children:"Transactions Latency"}),e.jsxs(t,{children:[r(s.stats.latencyStats?.transactions.latency)," ms"]})]})]})})}),e.jsx("div",{className:"flex-1 w-full",children:e.jsx(S,{className:"mt-4 lg:mt-0",children:e.jsxs(p,{children:[e.jsxs(l,{children:[e.jsx(t,{className:"font-bold",children:"Storage Size"}),e.jsxs(t,{children:[r(s.stats.storageStats?.storageSize)," B"]})]}),e.jsxs(l,{children:[e.jsx(t,{className:"font-bold",children:"Total Index Size"}),e.jsxs(t,{children:[r(s.stats.storageStats?.totalIndexSize)," B"]})]}),e.jsxs(l,{children:[e.jsx(t,{className:"font-bold",children:"Total Size"}),e.jsxs(t,{children:[r(s.stats.storageStats?.totalSize)," B"]})]}),e.jsxs(l,{children:[e.jsx(t,{className:"font-bold",children:"Count"}),e.jsx(t,{children:s.count})]}),e.jsxs(l,{children:[e.jsx(t,{className:"font-bold",children:"Collection Scans Total"}),e.jsx(t,{children:r(s.stats.queryExecStats?.collectionScans.total)})]}),e.jsxs(l,{children:[e.jsx(t,{className:"font-bold",children:"Collection Scans Non-Tailable"}),e.jsx(t,{children:r(s.stats.queryExecStats?.collectionScans.nonTailable)})]})]})})})]})})})]},n)})]}),e.jsxs(v,{lg:16,md:8,sm:4,className:"pb-10",children:[e.jsx("div",{className:"flex items-center justify-between pb-4 mt-10",children:e.jsxs("div",{className:"",children:[e.jsx("h4",{className:"text-xl font-medium",children:"Details"}),e.jsxs("p",{className:"text-sm",children:["Collections: ",a.collections]})]})}),e.jsx(S,{size:"lg",useZebraStyles:!1,children:e.jsxs(p,{children:[e.jsxs(l,{children:[e.jsxs(t,{children:[e.jsx("strong",{children:"Collections "}),e.jsx("small",{className:"block",children:"(incl. system.namespaces)"})]}),e.jsx(t,{children:a.collections})]}),e.jsxs(l,{children:[e.jsx(t,{children:e.jsx("strong",{children:"Data Size"})}),e.jsx(t,{children:a.dataSize})]}),e.jsxs(l,{children:[e.jsx(t,{children:e.jsx("strong",{children:"Storage Size"})}),e.jsx(t,{children:a.storageSize})]}),e.jsxs(l,{children:[e.jsx(t,{children:e.jsx("strong",{children:"Views"})}),e.jsx(t,{children:a.views})]}),e.jsxs(l,{children:[e.jsx(t,{children:e.jsx("strong",{children:"Avg Obj Size"})}),e.jsx(t,{children:a.avgObjSize})]}),e.jsxs(l,{children:[e.jsx(t,{children:e.jsx("strong",{children:"Objects"})}),e.jsx(t,{children:a.objects})]}),e.jsxs(l,{children:[e.jsx(t,{children:e.jsx("strong",{children:"Operation Time"})}),e.jsx(t,{children:a.operationTime})]}),e.jsxs(l,{children:[e.jsx(t,{children:e.jsx("strong",{children:"Cluster Time"})}),e.jsx(t,{children:a.clusterTime})]}),e.jsxs(l,{children:[e.jsx(t,{children:e.jsx("strong",{children:"Extents"})}),e.jsx(t,{children:a.numExtents})]}),e.jsxs(l,{children:[e.jsx(t,{children:e.jsx("strong",{children:"Extents Free List"})}),e.jsx(t,{children:a.extentFreeListNum})]}),e.jsxs(l,{children:[e.jsx(t,{children:e.jsx("strong",{children:"Indexes"})}),e.jsx(t,{children:a.indexes})]}),e.jsxs(l,{children:[e.jsx(t,{children:e.jsx("strong",{children:"Index Size"})}),e.jsx(t,{children:a.indexSize})]}),e.jsxs(l,{children:[e.jsx(t,{children:e.jsx("strong",{children:"Data File Version"})}),e.jsx(t,{children:a.dataFileVersion})]}),e.jsxs(l,{children:[e.jsx(t,{children:e.jsx("strong",{children:"File System Used Size"})}),e.jsx(t,{children:h(a.fsUsedSize)})]}),e.jsxs(l,{children:[e.jsx(t,{children:e.jsx("strong",{children:"File System Total Size"})}),e.jsx(t,{children:h(a.fsTotalSize)})]})]})})]})]}),e.jsx(q,{open:w,onClose:()=>{N(!1)},onSuccess:(s,n)=>{b(`/database/${s}/${n}`,{replace:!0})},dbName:a.name}),e.jsx(U,{open:z!==null,onClose:()=>{f(null)},collectionName:z||"",onSuccess:()=>{f(null),window.location.reload()},dbName:a.name}),e.jsx(H,{open:L,onClose:()=>{g(!1)},onSuccess:()=>{g(!1),b("/database",{replace:!0})},name:a.name})]})}export{he as default};
